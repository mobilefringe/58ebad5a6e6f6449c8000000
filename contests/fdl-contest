<div class="promo_page">
    <h1 class="page_title">Fleur de Lys Contest</h1> <!-- Contests -->
    <hr>
    <!-- No Contest Message -->
    <h3 id="no_contest" class="hidden_now">Fleur de Lys présentera un contest sous peu. Restez à l’affût pour plus de détails!</h3> 
    <div id="contest_container">
	    <script id="contest_template" type="x-tmpl-mustache/text">
            <div class="mobile_padding">
                {{#img_url}}
                <img class="contest_img" src="{{img_url}}" alt="{{name}}" />
                {{/img_url}}
                {{#rich_description}}
                <div class="contest_description"> {{{rich_description}}}</div>
                {{/rich_description}}
            </div>

            <form id="contest_form">
                <input id="property_id" name="contest[property_id]" type="hidden" value="{{property_id}}"/>
                <input id="contest_id" name="contest[contest_id]" type="hidden"  value="{{id}}" />
                <input type="hidden" name="cm-name" id="cm-name" />
                
                <div class="row">
                    <div class="col-sm-6">
                        <label for="first_name">First Name *</label>
                        <input class="contest_info" id="first_name" name="contest[first_name]" type="text" required data-validation="required" tabindex="1"/>
                    </div>
                    <div class="col-sm-6">
                        <label for="last_name">Last Name *</label>
                        <input class="contest_info" id="last_name" name="contest[last_name]" type="text" required data-validation="required" tabindex="2"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <label for="address">Address</label>
                        <input class="contest_info" id="address" name="contest[address]" type="text" value="" tabindex="3"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <label for="city">City</label>
                        <input class="contest_info" id="city" name="contest[city]" type="text"  value="" tabindex="4"/>
                    </div>
                    <div class="col-md-6">
                        <label for="province">Province</label>
                        <input class="contest_info" id="province" name="contest[province]" type="text"  value="Québec" tabindex="5"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">  
                        <label for="zip_code">Postal Code *</label>
                        <input class="contest_info" id="zip_code" name="contest[zip_code]" type="text" required data-validation="required" tabindex="6"/>
                    </div>
                    <div class="col-sm-6">
                        <label for="phone_number">Phone Number *</label>
                        <input class="contest_info" id="phone_number" name="contest[phone]" type="text" required data-validation="required" tabindex="7"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <label for="email">Email *</label>
                        <input class="contest_info" id="email" name="contest[email]" type="email" required data-validation-regexp="^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$" data-validation-error-msg="Please enter a valid email address" data-validation="custom" tabindex="8"/>
                    </div>
                </div>
                <div class="line_break">&nbsp;</div>
                <div class="row">
                    <div class="col-sm-12">    
                        <label>
                            <input id="newsletter_signup" type="checkbox" name="contest[newsletter]" tabindex="9"/> 
                            J'accepte de recevoir des communications de Fleur de Lys.
                        </label>
                        <div class="line_break">&nbsp;</div>
                        <label class="contest_rules">
                            <input id="agree_terms" type="checkbox" name="contest[contest_rules]" required data-validation="required" tabindex="9"/> 
                            J'ai lu et compris le <a href="/pages/fdl-contest-rules" target="_blank">Règlements du concours et règlements</a> 
et le <a href="/pages/fdl-privacy-policy" target="_blank">Politique de confidentialité</a>. 
                        </label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <button class="submit_btn caps" tabindex="10">Submit</button>
                    </div>
                    <div class="col-sm-6"></div>
                </div>
                <div class="line_break">&nbsp;</div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="margin_40"></div>
                        <p class="hidden_now" id="succes_msg">Thank you! Your entry has been received.</p>
                    </div>
                    <div class="col-sm-6">
                </div>
            </form>
        </script>
    </div>
</div>

<script>
    $(document).ready(function(e){
        init(e);
        
        function renderAll(){
            var contest_details = _.filter(getContestList(), function(o) { 
                o.img_url = "https://mallmaverick.cdn.speedyrails.net" + o.photo_url
                return o.show_on_slug === "fdl-contest"; 
                
            });
            console.log(contest_details)
            renderGeneral("#contest_container", "#contest_template", contest_details);

            $.validate();
            
            $('#contest_form').submit(function(e){
                e.preventDefault();
                $('.submit_btn').prop('disabled', true);
                submit_contest(slug);
            });
            
            show_content();
        }
        
        loadMallDataCached(renderAll); 
    });
</script>